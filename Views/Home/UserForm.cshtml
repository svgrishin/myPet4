@model myPet4.Models.UserData;
@using myPet4.Models;
@using myPet4.Controllers;

@{
    ViewData["Title"] = Model.Person.login;
    Layout = "~/Views/Shared/_Layout.cshtml";
}

<body id="userFormBody">

    <iframe style="height:fit-content; margin-left:5%;margin-right:5%;width:90%; min-width:1500px" id="test" src="@Url.Action("TopView")"></iframe>

    <table>
        <tr>
            <td style="min-width: 210px">
                <iframe src="@Url.Action("IncomeForm", new{id=Model.Person.id})"></iframe>
            </td>
            @foreach (UserData.UserItem userItem in Model.userItems)
            {
                <td style="min-width: 210px">
                    @*<iframe src="@Url.Action("TransactionsForm", new{id=userItem.item.id})" onload="FrameUpdate();"></iframe>*@
                    <iframe src="@Url.Action("TransactionsForm", new{id=userItem.item.id})" ></iframe>
                </td>
            }
        </tr>
    </table>
    @*<button onclick="FrameUpdate();">testBtn</button>*@
</body>
<script>
    function FrameUpdate() {
        document.getElementById('test').contentWindow.location.reload();
    }

    window.addEventListener('message', function (event) {
        //if (event.origin === 'http://localhost/') {
        //    alert('Received message: ' + event.data.message);
        //}
        //else {
        //    alert('Origin not allowed!');
        //}
        if (event.data.message === 'FrameUpdate') {
            alert('Received message: ' + event.data.message);
            FrameUpdate();
        }
        

    }, false);

</script>